package test.beast.evolution.tree;

import beast.evolution.tree.FlexibleTree;
import beast.evolution.tree.Node;
import junit.framework.TestCase;

/**
 * @author Walter Xie
 */
public class FlexibleTreeTest extends TestCase {
    String[] trees = new String[]{
            "((((A:1.0,B:1.0):1.0,C:2.0):2.0,D:3.0):3.0,E:5.0);", // binary tree
//            "(((((((((1[&height=10.773125657111258,height_95%_HPD={8.772436735146599,12.12849740828733},height_median=10.826317477603794,height_range={8.706830795691907,13.148994756501217},length=0.4923616461011468,length_95%_HPD={0.08603662672042134,1.0570849906288728},length_median=0.45282486078171047,length_range={0.0587507345687186,1.2991971421558972}]:0.4794364549376233,(2[&height=9.773125657111258,height_95%_HPD={7.772436735146599,11.128497408287323},height_median=9.826317477603794,height_range={7.706830795691907,12.14899475650121},length=0.3301127771973189,length_95%_HPD={0.017455992768105943,0.6974089130870311},length_median=0.25096227406459093,length_range={0.017455992768105943,1.7543488291212022}]:0.5244754192026733,((3[&height=0.0,length=9.292439475222656,length_95%_HPD={7.028167781735817,10.8297916994674},length_median=9.421823956907659,length_range={6.249161829585489,11.635093244044704}]:9.421823956907659,(8[&height=6.703809720161898,height_95%_HPD={4.473321731159963,8.618812474391774},height_median=6.649330556567826,height_range={3.886990939696389,9.777508497480632},length=2.203265329009664,length_95%_HPD={1.4500231394095522,3.251241879445409},length_median=2.1960781881584523,length_range={0.8835811684596564,3.251241879445409}]:2.3748197341088897,14[&height=7.773125657111259,height_95%_HPD={5.772436735146599,9.128497408287323},height_median=7.826317477603794,height_range={5.706830795691907,10.14899475650121},length=1.1720661020182106,length_95%_HPD={0.7326608053545911,1.5966727355642831},length_median=1.1377839035742525,length_range={0.5370055769794888,1.8905641111626892}]:1.197832813072921)[&height=8.998423552340244,height_95%_HPD={7.09978469418445,10.680390598626552},height_median=9.024150290676715,height_range={6.572118274368833,11.141321291189776},length=0.41905105578478985,length_95%_HPD={0.1494011008408478,0.7943662954088353},length_median=0.3776533700217506,length_range={0.10126096627183045,1.1651247495590162},posterior=0.9230769230769231]:0.39767366623094347)[&height=9.333460051450297,height_95%_HPD={7.465085258616057,10.8297916994674},height_median=9.421823956907659,height_range={7.028167781735817,11.635093244044704},length=0.6526209168252777,length_95%_HPD={0.05243653808343396,1.2260509975393958},length_median=0.6359204593895669,length_range={0.05243653808343396,1.6904439331469376},posterior=1.0]:0.4150192646142017,6[&height=8.773125657111262,height_95%_HPD={6.772436735146599,10.128497408287323},height_median=8.826317477603794,height_range={6.706830795691907,11.14899475650121},length=1.284768535947482,length_95%_HPD={0.6387147504784281,2.0098596634859263},length_median=1.2503804199408037,length_range={0.4866938579313711,2.5195668214024636}]:1.0105257439180662)[&height=9.767398377656873,height_95%_HPD={7.193524653623278,11.247942444857507},height_median=9.83684322152186,height_range={7.193524653623278,12.421999711556943},length=0.38417420531963614,length_95%_HPD={0.03960733993464771,0.9786577606373115},length_median=0.30333306426598483,length_range={0.03960733993464771,1.1954085423458984},posterior=0.42857142857142855]:0.5139496752846071)[&height=10.252461862132677,height_95%_HPD={8.316776921333897,11.867511551666482},height_median=10.350792896806468,height_range={7.724286788460013,12.498149119770062},length=1.0170022845822806,length_95%_HPD={0.18106326407965412,1.646091616589807},length_median=0.991884635223343,length_range={0.18106326407965412,1.8508954576884236},posterior=0.978021978021978]:0.9549610357349501)[&height=11.261970432340432,height_95%_HPD={9.15772311781636,12.73871305037996},height_median=11.305753932541418,height_range={9.142366352353061,13.902723703992365},length=0.670552227025851,length_95%_HPD={0.15169349458757253,1.1543433367210838},length_median=0.6823238169598334,length_range={0.022418191635441787,1.3728097260517274},posterior=0.9340659340659341]:0.6145576177012266,7[&height=11.77312565711126,height_95%_HPD={9.772436735146599,13.128497408287323},height_median=11.826317477603787,height_range={9.706830795691907,14.148994756501217},length=0.12159377594138793,length_95%_HPD={2.771283513993694E-4,0.32027098826358014},length_median=0.07561947699104365,length_range={2.771283513993694E-4,0.688565540673622}]:0.09399407263885706)[&height=11.905014554397033,height_95%_HPD={9.800060075303502,13.131334458683277},height_median=11.920311550242644,height_range={9.800060075303502,14.169389415967885},length=2.2901793662332866,length_95%_HPD={1.770612092166047,2.712676174493069},length_median=2.2746822759469865,length_range={1.5861129119318313,3.09130316574484},posterior=1.0]:2.3813758607634057,13[&height=13.773125657111258,height_95%_HPD={11.772436735146606,15.128497408287323},height_median=13.826317477603787,height_range={11.706830795691907,16.148994756501217},length=0.4220682635190621,length_95%_HPD={0.0698092343219443,0.7570356869407995},length_median=0.380231529354198,length_range={0.0698092343219443,1.1182406007940813}]:0.47536993340226275)[&height=14.195193920630325,height_95%_HPD={12.307431623374281,15.392917133902497},height_median=14.30168741100605,height_range={12.307431623374281,16.52697146566724},length=2.2899307992922107,length_95%_HPD={1.712571148488113,2.778152924759297},length_median=2.2729590997502775,length_range={1.4936842217679747,3.0023532311344354},posterior=1.0]:2.229633754828715,5[&height=15.773125657111258,height_95%_HPD={13.772436735146606,17.128497408287323},height_median=15.826317477603787,height_range={13.706830795691907,18.148994756501217},length=0.7119990628112736,length_95%_HPD={0.3295240569995137,1.0542037405525697},length_median=0.7238053389583143,length_range={0.13542049846694582,1.2388313177292325}]:0.7050036882309776)[&height=16.485124719922528,height_95%_HPD={14.523750362585936,17.991294453231735},height_median=16.531321165834765,height_range={14.523750362585936,19.197593561187382},length=0.7814191150123286,length_95%_HPD={0.24503427529819533,1.2928978574099794},length_median=0.7903220043183303,length_range={0.24503427529819533,1.5215059470906098},posterior=1.0]:0.7344653001780337,4[&height=16.77312565711125,height_95%_HPD={14.772436735146606,18.128497408287323},height_median=16.826317477603787,height_range={14.706830795691907,19.148994756501217},length=0.4934181778236021,length_95%_HPD={0.13701666836664472,0.9221730061415343},length_median=0.4711347717763772,length_range={0.13701666836664472,1.06519121521724}]:0.4394689884090113)[&height=17.266543834934865,height_95%_HPD={15.369812618891817,18.665484109779},height_median=17.2657864660128,height_range={15.036528515305054,19.990320848489304},length=9.20248730100472,length_95%_HPD={7.13115978390335,11.2063796447462},length_median=9.174628543660887,length_range={6.747464948760783,13.084107156836314},posterior=1.0]:9.0438807650279,(12[&height=14.773125657111258,height_95%_HPD={12.772436735146606,16.128497408287323},height_median=14.826317477603787,height_range={12.706830795691907,17.148994756501217},length=4.931683120063132,length_95%_HPD={3.61321843295935,6.462019954489989},length_median=4.87105348183535,length_range={3.133249170699713,7.387073964101219}]:4.912472221470459,(16[&height=14.773125657111258,height_95%_HPD={12.772436735146606,16.128497408287323},height_median=14.826317477603787,height_range={12.706830795691907,17.148994756501217},length=0.696380610545556,length_95%_HPD={0.10147045768410123,1.1295129016025207},length_median=0.6814396759445387,length_range={0.10147045768410123,1.6161844960055411}]:0.6833205553218775,17[&height=8.773125657111262,height_95%_HPD={6.772436735146606,10.128497408287323},height_median=8.826317477603787,height_range={6.706830795691907,11.148994756501217},length=6.696380610545554,length_95%_HPD={6.101470457684101,7.129512901602521},length_median=6.681439675944539,length_range={6.101470457684101,7.616184496005541}]:6.6833205553218775)[&height=15.469506267656815,height_95%_HPD={13.243320546852758,16.92114809542657},height_median=15.509638032925665,height_range={13.148234806316648,17.917058357350548},length=4.2353025095175765,length_95%_HPD={3.205970732800033,5.897583494713864},length_median=4.137899237158582,length_range={2.508065199631389,6.472023775353907},posterior=1.0]:4.2291516661485815)[&height=19.704808777174385,height_95%_HPD={17.54226568655633,22.190071638684408},height_median=19.738789699074246,height_range={16.36717501663915,22.190071638684408},length=6.764222358765192,length_95%_HPD={5.31021492391443,9.434851742631803},length_median=6.6989257339674175,length_range={4.300190581760141,10.705192756449811},posterior=1.0]:6.5708775319664525)[&height=26.46903113593959,height_95%_HPD={23.68959967863788,29.623014634016045},height_median=26.3096672310407,height_range={21.952147416182758,30.00721801907656},length=4.152809696263203,length_95%_HPD={1.8083470486803463,6.148378785077153},length_median=3.9685707391361333,length_range={1.610618036604837,8.988359892778604},posterior=1.0]:4.606254767540236,(10[&height=28.773125657111276,height_95%_HPD={26.772436735146606,30.128497408287323},height_median=28.826317477603787,height_range={26.706830795691907,31.148994756501217},length=0.7692767991610734,length_95%_HPD={0.09877192613897279,1.387933175521077},length_median=0.6998975758761681,length_range={0.09877192613897279,3.2122461585735564}]:0.6200577340220406,11[&height=8.773125657111262,height_95%_HPD={6.772436735146606,10.128497408287323},height_median=8.826317477603787,height_range={6.706830795691907,11.148994756501217},length=20.273263963825,length_95%_HPD={18.327508546408378,21.208248497735088},length_median=20.50583891229916,length_range={17.671708176379465,21.28441210852616}]:20.62005773402204)[&height=29.41821887040176,height_95%_HPD={28.005493843599943,30.76839826445177},height_median=29.446375211625828,height_range={27.392667149882076,31.53194356955552},length=2.025950939280961,length_95%_HPD={0.5144663259840101,3.2387966243522186},length_median=1.9417247865360565,length_range={0.5144663259840101,7.95085719102984},posterior=0.7582417582417582]:1.4695467869551067)[&height=30.955450176486416,height_95%_HPD={28.518223089548993,33.62162807427858},height_median=30.915921998580934,height_range={27.20986224844526,34.396754952931126},length=6.322878045640026,length_95%_HPD={4.352002626290933,7.944843732919573},length_median=6.346442363257669,length_range={3.734379142066821,8.514728619108332},posterior=0.978021978021978]:6.380809644030023,9[&height=36.77312565711127,height_95%_HPD={34.772436735146606,38.12849740828732},height_median=36.82631747760379,height_range={34.70683079569191,39.14899475650122},length=0.4893510944616098,length_95%_HPD={0.08297761611019894,1.001015328113958},length_median=0.4428408877682486,length_range={0.08297761611019894,1.3623260239676824}]:0.4704141650071705)[&height=37.30176736052746,height_95%_HPD={35.350564977685636,38.995577911855165},height_median=37.29673164261096,height_range={34.86908784696429,39.60727675573565},length=6.299745168943999,length_95%_HPD={4.234408842035521,8.695083902067417},length_median=6.247041793773008,length_range={3.721996130397713,9.763550582746646},posterior=1.0]:6.109683509236611,15[&height=29.77312565711128,height_95%_HPD={27.772436735146606,31.128497408287323},height_median=29.826317477603787,height_range={27.706830795691907,32.14899475650122},length=13.828386872360197,length_95%_HPD={11.815691724985214,16.507787474772663},length_median=13.6673777197446,length_range={11.084184605168979,17.188702999598753}]:13.580097674243781)[&height=43.601512529471464,height_95%_HPD={40.660314018806375,46.431244316547705},height_median=43.40641515184757,height_range={39.58497381972116,47.51680507946015},length=0.0,posterior=1.0]:0.0;"
    };
    String[] newTrees = new String[]{
            "(C:2.0,((A:1.0,B:1.0):1.0,(D:3.0,E:5.0):3.0):2.0):0.0;", // binary tree
//            "(((((((((1[&height=10.773125657111258,height_95%_HPD={8.772436735146599,12.12849740828733},height_median=10.826317477603794,height_range={8.706830795691907,13.148994756501217},length=0.4923616461011468,length_95%_HPD={0.08603662672042134,1.0570849906288728},length_median=0.45282486078171047,length_range={0.0587507345687186,1.2991971421558972}]:0.4794364549376233,(2[&height=9.773125657111258,height_95%_HPD={7.772436735146599,11.128497408287323},height_median=9.826317477603794,height_range={7.706830795691907,12.14899475650121},length=0.3301127771973189,length_95%_HPD={0.017455992768105943,0.6974089130870311},length_median=0.25096227406459093,length_range={0.017455992768105943,1.7543488291212022}]:0.5244754192026733,((3[&height=0.0,length=9.292439475222656,length_95%_HPD={7.028167781735817,10.8297916994674},length_median=9.421823956907659,length_range={6.249161829585489,11.635093244044704}]:9.421823956907659,(8[&height=6.703809720161898,height_95%_HPD={4.473321731159963,8.618812474391774},height_median=6.649330556567826,height_range={3.886990939696389,9.777508497480632},length=2.203265329009664,length_95%_HPD={1.4500231394095522,3.251241879445409},length_median=2.1960781881584523,length_range={0.8835811684596564,3.251241879445409}]:2.3748197341088897,14[&height=7.773125657111259,height_95%_HPD={5.772436735146599,9.128497408287323},height_median=7.826317477603794,height_range={5.706830795691907,10.14899475650121},length=1.1720661020182106,length_95%_HPD={0.7326608053545911,1.5966727355642831},length_median=1.1377839035742525,length_range={0.5370055769794888,1.8905641111626892}]:1.197832813072921)[&height=8.998423552340244,height_95%_HPD={7.09978469418445,10.680390598626552},height_median=9.024150290676715,height_range={6.572118274368833,11.141321291189776},length=0.41905105578478985,length_95%_HPD={0.1494011008408478,0.7943662954088353},length_median=0.3776533700217506,length_range={0.10126096627183045,1.1651247495590162},posterior=0.9230769230769231]:0.39767366623094347)[&height=9.333460051450297,height_95%_HPD={7.465085258616057,10.8297916994674},height_median=9.421823956907659,height_range={7.028167781735817,11.635093244044704},length=0.6526209168252777,length_95%_HPD={0.05243653808343396,1.2260509975393958},length_median=0.6359204593895669,length_range={0.05243653808343396,1.6904439331469376},posterior=1.0]:0.4150192646142017,6[&height=8.773125657111262,height_95%_HPD={6.772436735146599,10.128497408287323},height_median=8.826317477603794,height_range={6.706830795691907,11.14899475650121},length=1.284768535947482,length_95%_HPD={0.6387147504784281,2.0098596634859263},length_median=1.2503804199408037,length_range={0.4866938579313711,2.5195668214024636}]:1.0105257439180662)[&height=9.767398377656873,height_95%_HPD={7.193524653623278,11.247942444857507},height_median=9.83684322152186,height_range={7.193524653623278,12.421999711556943},length=0.38417420531963614,length_95%_HPD={0.03960733993464771,0.9786577606373115},length_median=0.30333306426598483,length_range={0.03960733993464771,1.1954085423458984},posterior=0.42857142857142855]:0.5139496752846071)[&height=10.252461862132677,height_95%_HPD={8.316776921333897,11.867511551666482},height_median=10.350792896806468,height_range={7.724286788460013,12.498149119770062},length=1.0170022845822806,length_95%_HPD={0.18106326407965412,1.646091616589807},length_median=0.991884635223343,length_range={0.18106326407965412,1.8508954576884236},posterior=0.978021978021978]:0.9549610357349501)[&height=11.261970432340432,height_95%_HPD={9.15772311781636,12.73871305037996},height_median=11.305753932541418,height_range={9.142366352353061,13.902723703992365},length=0.670552227025851,length_95%_HPD={0.15169349458757253,1.1543433367210838},length_median=0.6823238169598334,length_range={0.022418191635441787,1.3728097260517274},posterior=0.9340659340659341]:0.6145576177012266,7[&height=11.77312565711126,height_95%_HPD={9.772436735146599,13.128497408287323},height_median=11.826317477603787,height_range={9.706830795691907,14.148994756501217},length=0.12159377594138793,length_95%_HPD={2.771283513993694E-4,0.32027098826358014},length_median=0.07561947699104365,length_range={2.771283513993694E-4,0.688565540673622}]:0.09399407263885706)[&height=11.905014554397033,height_95%_HPD={9.800060075303502,13.131334458683277},height_median=11.920311550242644,height_range={9.800060075303502,14.169389415967885},length=2.2901793662332866,length_95%_HPD={1.770612092166047,2.712676174493069},length_median=2.2746822759469865,length_range={1.5861129119318313,3.09130316574484},posterior=1.0]:2.3813758607634057,13[&height=13.773125657111258,height_95%_HPD={11.772436735146606,15.128497408287323},height_median=13.826317477603787,height_range={11.706830795691907,16.148994756501217},length=0.4220682635190621,length_95%_HPD={0.0698092343219443,0.7570356869407995},length_median=0.380231529354198,length_range={0.0698092343219443,1.1182406007940813}]:0.47536993340226275)[&height=14.195193920630325,height_95%_HPD={12.307431623374281,15.392917133902497},height_median=14.30168741100605,height_range={12.307431623374281,16.52697146566724},length=2.2899307992922107,length_95%_HPD={1.712571148488113,2.778152924759297},length_median=2.2729590997502775,length_range={1.4936842217679747,3.0023532311344354},posterior=1.0]:2.229633754828715,5[&height=15.773125657111258,height_95%_HPD={13.772436735146606,17.128497408287323},height_median=15.826317477603787,height_range={13.706830795691907,18.148994756501217},length=0.7119990628112736,length_95%_HPD={0.3295240569995137,1.0542037405525697},length_median=0.7238053389583143,length_range={0.13542049846694582,1.2388313177292325}]:0.7050036882309776)[&height=16.485124719922528,height_95%_HPD={14.523750362585936,17.991294453231735},height_median=16.531321165834765,height_range={14.523750362585936,19.197593561187382},length=0.7814191150123286,length_95%_HPD={0.24503427529819533,1.2928978574099794},length_median=0.7903220043183303,length_range={0.24503427529819533,1.5215059470906098},posterior=1.0]:0.7344653001780337,4[&height=16.77312565711125,height_95%_HPD={14.772436735146606,18.128497408287323},height_median=16.826317477603787,height_range={14.706830795691907,19.148994756501217},length=0.4934181778236021,length_95%_HPD={0.13701666836664472,0.9221730061415343},length_median=0.4711347717763772,length_range={0.13701666836664472,1.06519121521724}]:0.4394689884090113)[&height=17.266543834934865,height_95%_HPD={15.369812618891817,18.665484109779},height_median=17.2657864660128,height_range={15.036528515305054,19.990320848489304},length=9.20248730100472,length_95%_HPD={7.13115978390335,11.2063796447462},length_median=9.174628543660887,length_range={6.747464948760783,13.084107156836314},posterior=1.0]:9.0438807650279,(12[&height=14.773125657111258,height_95%_HPD={12.772436735146606,16.128497408287323},height_median=14.826317477603787,height_range={12.706830795691907,17.148994756501217},length=4.931683120063132,length_95%_HPD={3.61321843295935,6.462019954489989},length_median=4.87105348183535,length_range={3.133249170699713,7.387073964101219}]:4.912472221470459,(16[&height=14.773125657111258,height_95%_HPD={12.772436735146606,16.128497408287323},height_median=14.826317477603787,height_range={12.706830795691907,17.148994756501217},length=0.696380610545556,length_95%_HPD={0.10147045768410123,1.1295129016025207},length_median=0.6814396759445387,length_range={0.10147045768410123,1.6161844960055411}]:0.6833205553218775,17[&height=8.773125657111262,height_95%_HPD={6.772436735146606,10.128497408287323},height_median=8.826317477603787,height_range={6.706830795691907,11.148994756501217},length=6.696380610545554,length_95%_HPD={6.101470457684101,7.129512901602521},length_median=6.681439675944539,length_range={6.101470457684101,7.616184496005541}]:6.6833205553218775)[&height=15.469506267656815,height_95%_HPD={13.243320546852758,16.92114809542657},height_median=15.509638032925665,height_range={13.148234806316648,17.917058357350548},length=4.2353025095175765,length_95%_HPD={3.205970732800033,5.897583494713864},length_median=4.137899237158582,length_range={2.508065199631389,6.472023775353907},posterior=1.0]:4.2291516661485815)[&height=19.704808777174385,height_95%_HPD={17.54226568655633,22.190071638684408},height_median=19.738789699074246,height_range={16.36717501663915,22.190071638684408},length=6.764222358765192,length_95%_HPD={5.31021492391443,9.434851742631803},length_median=6.6989257339674175,length_range={4.300190581760141,10.705192756449811},posterior=1.0]:6.5708775319664525)[&height=26.46903113593959,height_95%_HPD={23.68959967863788,29.623014634016045},height_median=26.3096672310407,height_range={21.952147416182758,30.00721801907656},length=4.152809696263203,length_95%_HPD={1.8083470486803463,6.148378785077153},length_median=3.9685707391361333,length_range={1.610618036604837,8.988359892778604},posterior=1.0]:4.606254767540236,(10[&height=28.773125657111276,height_95%_HPD={26.772436735146606,30.128497408287323},height_median=28.826317477603787,height_range={26.706830795691907,31.148994756501217},length=0.7692767991610734,length_95%_HPD={0.09877192613897279,1.387933175521077},length_median=0.6998975758761681,length_range={0.09877192613897279,3.2122461585735564}]:0.6200577340220406,11[&height=8.773125657111262,height_95%_HPD={6.772436735146606,10.128497408287323},height_median=8.826317477603787,height_range={6.706830795691907,11.148994756501217},length=20.273263963825,length_95%_HPD={18.327508546408378,21.208248497735088},length_median=20.50583891229916,length_range={17.671708176379465,21.28441210852616}]:20.62005773402204)[&height=29.41821887040176,height_95%_HPD={28.005493843599943,30.76839826445177},height_median=29.446375211625828,height_range={27.392667149882076,31.53194356955552},length=2.025950939280961,length_95%_HPD={0.5144663259840101,3.2387966243522186},length_median=1.9417247865360565,length_range={0.5144663259840101,7.95085719102984},posterior=0.7582417582417582]:1.4695467869551067)[&height=30.955450176486416,height_95%_HPD={28.518223089548993,33.62162807427858},height_median=30.915921998580934,height_range={27.20986224844526,34.396754952931126},length=6.322878045640026,length_95%_HPD={4.352002626290933,7.944843732919573},length_median=6.346442363257669,length_range={3.734379142066821,8.514728619108332},posterior=0.978021978021978]:6.380809644030023,9[&height=36.77312565711127,height_95%_HPD={34.772436735146606,38.12849740828732},height_median=36.82631747760379,height_range={34.70683079569191,39.14899475650122},length=0.4893510944616098,length_95%_HPD={0.08297761611019894,1.001015328113958},length_median=0.4428408877682486,length_range={0.08297761611019894,1.3623260239676824}]:0.4704141650071705)[&height=37.30176736052746,height_95%_HPD={35.350564977685636,38.995577911855165},height_median=37.29673164261096,height_range={34.86908784696429,39.60727675573565},length=6.299745168943999,length_95%_HPD={4.234408842035521,8.695083902067417},length_median=6.247041793773008,length_range={3.721996130397713,9.763550582746646},posterior=1.0]:6.109683509236611,15[&height=29.77312565711128,height_95%_HPD={27.772436735146606,31.128497408287323},height_median=29.826317477603787,height_range={27.706830795691907,32.14899475650122},length=13.828386872360197,length_95%_HPD={11.815691724985214,16.507787474772663},length_median=13.6673777197446,length_range={11.084184605168979,17.188702999598753}]:13.580097674243781)[&height=43.601512529471464,height_95%_HPD={40.660314018806375,46.431244316547705},height_median=43.40641515184757,height_range={39.58497381972116,47.51680507946015},length=0.0,posterior=1.0]:0.0;"
    };

    public void testChangeRootTo() throws Exception {

        for (int i = 0; i < trees.length; i++) {
            String tree = trees[i];

            System.out.println("Change root of tree " + i );

            FlexibleTree flexibleTree = new FlexibleTree(tree);

            System.out.println(flexibleTree.getRoot().toNewick());

            // set new root between C and its parent with half length each side
            Node newRoot = flexibleTree.getNode(2);
            flexibleTree.changeRootTo(newRoot, 0.5);
            String newTree = flexibleTree.getRoot().toNewick();

            System.out.println(newTree);

            if (!newTree.endsWith(";"))
                newTree += ";";

            assertEquals(newTrees[i], newTree);
        }

    }
}
